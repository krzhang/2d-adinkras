\section{Every $2$-d Adinkra is a Quotient of a Vertex-switched Product}
\label{sec:quotient}

In Section~\ref{sec:products}, we showed that we can construct a $2$-d Adinkra by a product construction of two $1$-d Adinkras, each of which appears on the boundary of the product. In this section, we settle a conjecture of H\"ubsch \cite{hubsch:weaving} by showing that every $2$-d Adinkra is in fact a quotient of the the product of the two $1$-d Adinkras on its lower boundary. Our main result is:

\begin{thm}
\label{thm:quotient}
Let $A$ be a connected $2$-d Adinkra.  Fix a vertex $\overline{0}$ in $A$ and let $A_L^0$ (resp. $A_R^0$) be the connected component of $A_L$ (resp. $A_R$) containing $\overline{0}$. Then there exists a binary linear block code $K$, and a vertex switch $F$ so that there is a distant action of $K$ on $F(A_L^0\times A_R^0)$ that preserves colors, dashing, and bigrading, and so that
\[F(A_L^0\times A_R^0)/K\cong A\]
as an isomorphism of $2$-d Adinkras (that is, as an isomorphism of graphs that preserves colors, dashing, and bigrading).  Furthermore
\begin{equation}
\label{eqn:kcomplement}
C(A)=Z_L(C(A_L^0))\oplus Z_R(C(A_R^0))\oplus K
\end{equation}
as an internal direct sum.
\end{thm}


We first prove the existence of $K$ satisfying (\ref{eqn:kcomplement}).  We then construct a color and bigrading preserving graph isomorphism
\[\tilde{\Phi}:(A_L^0\times A_R^0)/K\to A.\]
Finally we identify the vertex switching $F$ that proves the theorem.


\begin{lem}
\label{lem:cplus}
\[Z_L(C(A_L^0))\oplus Z_R(C(A_R^0)) \subseteq C(A).\]
\end{lem}
\begin{proof}
Let $g\in Z_L(C(A_L^0))$ and $h\in Z_R(C(A_R^0))$.  Then $g\overline{0}=\overline{0}$ because applying $g$ to $\overline{0}$ results in a path that lies completely inside $A_L^0$, and so the fact that $g\overline{0}=\overline{0}$ in $A_L^0$ (since $g\in Z_L(C(A_L^0))$) results in $g\overline{0}=\overline{0}$ in $A$.  Likewise $h\overline{0}=\overline{0}$.  So $(g+h)\overline{0}=g(h(\overline{0}))=\overline{0}$ and $g+h\in C(A)$.
\end{proof}

\begin{lem}
\label{lem:existk}
There exists a binary linear block code $K$ so that
\[C(A)=Z_L(C(A_L^0))\oplus Z_R(C(A_R^0))\oplus K.
\]
\end{lem}
\begin{proof}
From Lemma~\ref{lem:cplus} and basic linear algebra, there exists a vector subspace $K$ of $\ZZ_2^n$ that is a vector space complement of
$Z_L(C(A_L^0))\oplus Z_R(C(A_R^0))$ in $C(A)$.  That is,
\[C(A)=Z_L(C(A_L^0))\oplus Z_R(C(A_R^0))\oplus K.\]
\end{proof}

\begin{lem}
\label{lem:kaction}
There is a faithful, distant action of $K$ on $A_L^0\times A_R^0$ that preserves colors and the bigrading.
\end{lem}
\begin{proof}
Considering $A_L^0\times A_R^0$ as a $1$-d Adinkra, we have a color-preserving action of $\ZZ_2^n$ on $A_L^0\times A_R^0$.  Examining the product structure of $A_L^0\times A_R^0$, if we have $\vec{x}\in \ZZ_2^n$, the action is
\[\vec{x}(v_1,v_2)=(\pi_L(\vec{x})v_1,\pi_R(\vec{x})v_2).\]

When this action is restricted to $K$, the action is faithful because $K\cap (Z_L(C(A_L^0))\oplus Z_R(C(A_R^0)))=0$.  Since $K$ is a subgroup of $C(A)$, which is doubly even, we see that the action of $K$ is distant.

Suppose $(v_1,v_2)\in A_L^0\times A_R^0$ and $g\in C(A)$.  The action of $g$ on $(v_1,v_2)$ gives $g(v_1,v_2)=(\pi_L(g)v_1,\pi_R(g)v_2)$.  Then $h_L(g(v_1,v_2))=h_L(\pi_L(g)v_1)$, which by Proposition~\ref{prop:heightcode}, is $h_L(v_1)$, which is $h_L(v_1,v_2)$.  Likewise, $h_R(g(v_1,v_2))=h_R(v_1,v_2)$.  Therefore the action of $K$ preserves the bigrading.

\end{proof}

\begin{cor}
\label{cor:kquotient}
There is a distant action of $K$ on $A_L^0\times A_R^0$ so that $(A_L^0\times A_R^0)/K$ is a well-defined $2$-d Adinkra without dashing: that is, a graph with colors and bigrading, satisfying the conditions of a $2$-d Adinkra except those that refer to dashing.
\end{cor}
\begin{proof}
This is a consequence of Lemma~\ref{lem:kaction} and Proposition~\ref{prop:quotient2}.
\end{proof}

\begin{definition}
Define a map of vertices
\[\Phi:A_L^0\times A_R^0 \to A\]
as follows.

Let $(v_1,v_2)\in A_L^0\times A_R^0$.  Then by Proposition~\ref{prop:transitive}, there is a word $\vec{x}_1\in \ZZ_2^p$ so that $\vec{x}_1\overline{0}=v_1$ and a word $\vec{x}_2 \in\ZZ_2^q$ so that $\vec{x}_2\overline{0}=v_2$.  We define $\Phi(v_1,v_2)=(Z_L(\vec{x}_1)+Z_R(\vec{x}_2))\overline{0}$ in $A$.

The $\vec{x}_1$ and $\vec{x}_2$ are determined up to $C(A_L^0)$ and $C(A_R^0)$, respectively.  Since $Z_L(C(A_L^0))$ and $Z_R(C(A_R^0))$ are subgroups of $C(A)$, we see that the definition of $\Phi(v_1,v_2)$ does not depend on these choices.
\end{definition}


\begin{lem}
\label{lem:gphi}
If $g\in \ZZ_2^n$, then
\[\Phi(g(v_1,v_2))=g\Phi(v_1,v_2).\]
\end{lem}
\begin{proof}
Let $\vec{x}_1\in \ZZ_2^p$ be such that $\vec{x}_1\overline{0}=v_1$ in $A_L^0$ and $\vec{x}_2\in \ZZ_2^q$ be such that $\vec{x}_2\overline{0}=v_2$ in $A_R^0$.  Then $\pi_L(g)v_1 = \pi_L(g)\vec{x}_1\overline{0}=(\pi_L(g)+\vec{x}_1)\overline{0}$ and likewise $\pi_R(g)v_2=(\pi_R(g)+\vec{x}_2)\overline{0}$.  Then
\begin{eqnarray*}
\Phi(g(v_1,v_2))&=&\Phi(\pi_L(g)v_1,\pi_R(g)v_2)\\
&=&(Z_L(\pi_L(g)+\vec{x}_1)+Z_R(\pi_R(g)+\vec{x}_2))\overline{0}\\
&=&(g+Z_L(\vec{x}_1)+Z_R(\vec{x}_2))\overline{0}\\
&=&g(Z_L(\vec{x}_1)+Z_R(\vec{x}_2))\overline{0}\\
&=&g\Phi(v_1,v_2)
\end{eqnarray*}
\end{proof}


\begin{lem}
\label{lem:mainhomo}
The map $\Phi$ defines a graph homomorphism
\[\Phi:A_L^0\times A_R^0 \to A\]
that preserves colors and bigrading.
\end{lem}
\begin{proof}
Suppose $i$ is a color and $(v_1,v_2)\in A_L^0\times A_R^0$ with $v_1=\vec{x}_1\overline{0}$ and $v_2=\vec{x}_2\overline{0}$.  Let $\vec{e}_i$ be the vector that has a single $1$ in the $i$th bit and $0$s elsewhere, so that for all vertices $v$, $\vec{e}_i v=q_i(v)$.  Using Lemma~\ref{lem:gphi}, we see that $\Phi(\vec{e}(v_1,v_2))=\vec{e}\Phi(v_1,v_2)$, so $\Phi$ sends edges of color $i$ to edges of color $i$.

Now consider $h_L$.
\begin{eqnarray*}
h_L(\Phi(v_1,v_2)) &=& h_L((Z_L(\vec{x}_1)+Z_R(\vec{x}_2))\overline{0})\\
 &=& h_L(Z_R(\vec{x}_2)Z_L(\vec{x}_1)\overline{0})\\
\end{eqnarray*}
Since $Z_R(\vec{x}_2)$ follows right-moving colors, this does not affect $h_L$, and so the above is
\[h_L(Z_L(\vec{x}_1)\overline{0}).\]
Since $Z_L(\vec{x}_1)\overline{0}$ in $A$ is the same as $\vec{x}_1\overline{0}$ in $A_L^0$, we have that this is $h(v_1)$.  On the other hand, in $A_L^0\times A_R^0$, this is $h_L(v_1,v_2)$.

Therefore $\Phi$ preserves $h_L$.  The fact that it preserves $h_R$ is proved similarly.
\end{proof}

\begin{lem}
\label{lem:mainiso}
The graph homomorphism $\Phi$ descends to a graph isomorphism
\[\tilde{\Phi}:(A_L^0\times A_R^0)/K \to A\]
that preserves colors and bigrading.
\end{lem}
\begin{proof}
Let $g\in C(A)$.  By Lemma~\ref{lem:gphi}, $\Phi(g(v_1,v_2))=g\Phi(v_1,v_2)=\Phi(v_1,v_2)$.  Therefore $\Phi$ actually descends to the quotient:
\[\tilde{\Phi}:(A_L^0\times A_R^0)/K\to A\]

We now show that $\tilde{\Phi}$ is an isomorphism.

To show that $\tilde{\Phi}$ is onto, let $v$ be a vertex in $A$.  Since $A$ is connected, there is a word $\vec{x}\in \ZZ_2^n$ so that $\vec{x}\overline{0}=v$.  Let $v_1=\pi_L(\vec{x})\overline{0}$ in $A_L^0$ and $v_2=\pi_R(\vec{x})\overline{0}$ in $A_R^0$.  Then $\Phi(v_1,v_2)=(Z_L(\pi_L(\vec{x})) + Z_R(\pi_R(\vec{x})))\overline{0} = \vec{x}\overline{0}= v$.

To show that $\tilde{\Phi}$ is one-to-one, suppose $(v_1,v_2)$ and $(v_3,v_4)$ are vertices in $A_L^0\times A_R^0$ and suppose $\Phi(v_1,v_2)=\Phi(v_3,v_4)$.  Define $\vec{x}_1$, $\vec{x}_2$, $\vec{x}_3$, and $\vec{x}_4$ as above, so that $\vec{x}_1\overline{0}=v_1$, and so on.  We then have $(Z_L(\vec{x}_1)+Z_R(\vec{x}_2))\overline{0}=(Z_L(\vec{x}_3) +Z_R(\vec{x}_4))\overline{0}$.  Then $(Z_L(\vec{x}_3-\vec{x}_1)+Z_R(\vec{x_4}-\vec{x}_2))\overline{0}=\overline{0}$, so that if we let $\vec{y}=Z_L(\vec{x}_3-\vec{x}_1)+Z_R(\vec{x_4}-\vec{x}_2)$, then $\vec{y}\in C(A)$ and $\vec{y}(v_1,v_2)=(v_3,v_4)$.

Since $C(A)=Z_L(C(A_L^0))\oplus Z_R(C(A_R^0))\oplus K$, we can write $\vec{y}=\vec{y}_1+\vec{y}_2+\vec{y}_3$ where $\vec{y}_1\in Z_L(C(A_L^0))$, $\vec{y}_2\in Z_R(C(A_R^0))$, and $\vec{y}_3\in K$.
\begin{eqnarray*}
(\vec{y}_1+\vec{y}_2+\vec{y}_3)(v_1,v_2)&=&(v_3,v_4)\\
\vec{y}_3(\pi_L(\vec{y}_1)v_1,\pi_R(\vec{y}_2)v_2)&=&(v_3,v_4)\\
\vec{y}_3(v_1,v_2)&=&(v_3,v_4)
\end{eqnarray*}
This proves that $\tilde{\Phi}$ is one-to-one.


Note that $\Phi(v,\overline{0})=v$ on $A_L^0\times\{\overline{0}\}$, and $\Phi(\overline{0},v)=v$ on $\{\overline{0}\}\times A_R^0$.


\end{proof}



Unfortunately, it is too much to expect the dashing on $(A_L^0\times A_R^0)/K$ to agree with the dashing on $A$; it is also almost always false that the dashing on $A_L^0\times A_R^0$ is invariant under the quotienting action of $K$. However, if we allow the operation of \emph{vertex switching}, then we can basically accomplish these goals, giving $F$ of Theorem~\ref{thm:quotient}.






Consider the dashing $\mu$ on $A$.  This restricts to $A_L^0$ and $A_R^0$, and Construction~\ref{const:product} produces a dashing $\mu_1$ on $A_L^0\times A_R^0$.   The graph homomorphism
\[\Phi:A_L^0\times A_R^0\to A\]
pulls back the dashing $\mu$ to $\mu_2$ on $A_L^0\times A_R^0$. While $\mu_1$ and $\mu_2$ are fairly different, they agree on the ``lower boundary:''

\begin{lem}
\label{lem:agree-on-boundary}
The dashings $\mu_1$ and $\mu_2$ agree on $A_L^0\times \{\overline{0}\}$ and on $\{\overline{0}\}\times A_R^0$.
\end{lem}
\begin{proof}
The construction of $\mu_1$ gives all edges in $A_L^0\times\{\overline{0}\}$ as the same as in $A_L^0$ under the association of every edge $(v,w)$ with $((v,\overline{0}),(w,\overline{0}))$.  For $\mu_2$, consider that for every vector $v\in A_L^0$,  $\Phi$ sends $(v,\overline{0})$ to $v$, and likewise any edges in $A_L^0$ will be sent to the corresponding edge in $A_L^0\times\{\overline{0}\}$.  Therefore $\mu_1$ and $\mu_2$ agree on $A_L^0\times\{\overline{0}\}$.  Likewise for $\{0\}\times A_R^0$.
\end{proof}


\begin{lem}
\label{lem:cycles-switching-class}
Two dashings have the same parity on all cycles\footnote{This type of result has a natural reformulation with homological algebra, done in independent ways by the first author's work using cubical cohomology \cite{dil:cohomology} and the second author's work using CW-complexes \cite{zhang:adinkras}. In either formulation, having parities of $\mu_1$ and $\mu_2$ agree on cycles is equivalent to $\mu_1 = \mu_2 = 0$ in cohomology.} if and only if they belong to the same vertex switching class.
\end{lem}

\begin{proof}
Let the dashings be $\mu$ and $\mu'$ on the Adinkra $A$. Since vertex switching preserves parity on any cycle, the ``if'' direction is trivial and it suffices to prove the other direction.

Assume $\mu$ and $\mu'$ have the same parity on all cycles. It suffices to prove the statement for $A$ connected, since we can repeat our argument on each connected component of $A$. Pick a spanning tree $T$ of $A$, and pick a vertex $v$ of $A$ to serve as the root. The choice of $v$ induces a map $d$ on the vertices of $A$ that associates to each vertex its distance from $v$ using just edges in $T$ (so $d(v) = 0$), which in turn induces a map on the edges of $T$ by associating to each edge $(x,y)$ the min of $d(x)$ and $d(y)$ (these two values are necessarily $1$ apart). We denote this value $d(x,y)$, which gives a partial ordering on the edges of $T$, which we also call $d$ by slight abuse of notation; to be precise, $d((x,y)) < d((x,y))$ in the ordering $d$ whenever $d(x,y) < d(x,y)$ in the edge function $d$.

Now, extend $d$ to a total ordering $d'$ on the edges of $T$. We claim that we can vertex switch $\mu$ such that $\mu$ agrees with $\mu'$ on $T$. Take the minimal edge $e$ (under $d'$) where the two dashings differ. $e = (x,y)$, where without loss of generality $d(y) > d(x)$. Note that vertex switching at $y$ cannot change the dashing on any of the edges $e < e'$ under the ordering $d'$, since otherwise $d(y)$ should have been assigned a smaller value. Thus, we can greedily vertex switch to make $\mu$ and $\mu'$ equal on $T$.

Finally, if $\mu$ and $\mu'$ are equal on $T$, consider any edge $e$ not in $T$. This edge completes at least one cycle with edges in $T$ (otherwise $T$ was not a minimal spanning tree). Since the two cycles have the same parity in $\mu$ and $\mu'$ by assumption and the dashings agree on all edges but $e$, $e$ must be dashed in the same way under the two dashings. Thus, the two dashings must actually agree on all edges, meaning the two original dashings are in the same vertex switching class.
% However, since $\mu$ and $\mu'$ agree on all cyclesminimal cycles, they agree on all cycles by Lemma~\ref{lem:minimal-cycles-to-all-cycles}, and in particular this cycle. 

\end{proof}




\begin{lem}
\label{lem:switch12}
The parities of $\mu_1$ and $\mu_2$ agree on every cycle of $A_L^0\times A_R^0$.

Hence, by the above lemma, there exists a vertex switching that sends $\mu_1$ to $\mu_2$.
\end{lem}
\begin{proof}
Let our cycle be $(v_0,v_1,\ldots,v_k)$ with $v_0=v_k$.  We first consider the case where $v_0=\overline{0}$.

For this proof, we define a \emph{color sequence} of a path to be the sequence of colors $(c(v_0,v_1),c(v_1,v_2),\ldots,c(v_{k-1},v_k))$ of edges along the path.  Note that given a starting vertex $v_0$ and a color sequence, there is a unique path that starts at $v_0$ with that color sequence.  This follows by applying induction to Property 2 of the definition of an Adinkra.

We begin with the color sequence for the cycle $(v_0,\ldots,v_k)$.  We will now describe a series of modifications to this cycle, described by modifying the color sequence.  The idea is to perform a ``bubble sort'', by iteratively swapping adjacent colors until the left-moving colors are all at the beginning and the right-moving colors are all at the end.

First, given a color sequence
\[(i_1,\ldots,i_{j-1},i_j,i_{j+1},i_{j+2},\ldots,i_k)\]
an adjacent swap results in a color sequence
\[(i_1,\ldots,i_{j-1},i_{j+1},i_j,i_{j+2},\ldots,i_k).\]
Modifying a color sequence in this way leads to a new path from $\overline{0}$.  The path is unchanged up to $v_{j-1}$, but by the definition of Adinkras, property 3, the path returns to $v_{j+1}$ so it is only $v_j$ that has changed.  Thus, the new path is still a cycle starting at $\overline{0}$.  The effect on the parity of any dashing is, by property 4, to add $1$ modulo $2$.  In particular, $\mu_1$ and $\mu_2$ are both affected in the same way.

It is straightforward to find a series of adjacent swaps so that the left-moving colors are moved to the beginning of the color sequence.  Then the resulting path starts from $\overline{0}$, stays in $A_L^0\times\{0\}$, then follows right-moving edges, ending in $\overline{0}$.  Since the right-moving edges end in $\overline{0}$, it must be that the right-moving edges are in $\{0\}\times A_R^0$.  By Lemma~\ref{lem:agree-on-boundary}, $\mu_1$ and $\mu_2$ are equal here, and so their parity on this modified path is the same.  Therefore, their parity on the original loop was the same.

Now we consider loops $p$ where $v_0\not=\overline{0}$.  Since $A_L^0\times A_R^0$ is connected, there is a path $p_0$ from $\overline{0}$ to $v_0$.  Take the path $p_0$, followed by $p$, then followed by $p_0^{-1}$ (meaning $p_0$ traversed in the opposite sense).  This is a loop starting and ending in $\overline{0}$, but the parity of a dashing is the same as that of $p$, since every new edge in $p_0$ is counterbalanced by a new edge in $p_0^{-1}$.  Therefore the parity of $\mu_1$ and $\mu_2$ agree on all loops.
\end{proof}


\begin{proof}[Proof of Theorem~\ref{thm:quotient}]
Given a $2$-d Adinkra $A$, select a vertex $\overline{0}$ of $A$ and let $A_L^0$ and $A_R^0$ be the connected components of $A_L$ and $A_R$, respectively, that contain $\overline{0}$.  By Lemma~\ref{lem:existk}, there exists a binary linear block code $K$ so that
\[C(A)=Z_L(C(A_L^0))\oplus Z_R(C(A_R^0))\oplus K.
\]
Use Construction~\ref{const:product} to construct the $2$-d Adinkra $A_L^0\times A_R^0$ with dashing $\mu_1$.
By Lemma~\ref{lem:mainhomo}, there is a graph homomorphism
\[\Phi:A_L^0\times A_R^0 \to A\]
that preserves colors and bigrading.  If we take the dashing $\mu$ from $A$, and pull it back to a dashing $\mu_2$ on $A_L^0\times A_R^0$, then Lemma~\ref{lem:switch12} says that there exists a vertex switch $F$ sending $\mu_1$ to $\mu_2$.

By Corollary~\ref{cor:kquotient}, $K$ acts on $A_L^0\times A_R^0$ to produce a well-defined $2$-d Adinkra without dashing:
\[(A_L^0\times A_R^0)/K\]
Since $\mu_2$ is invariant under $K$, there is a well-defined $2$-d Adinkra with dashing
\[F(A_L^0\times A_R^0)/K\]
Note that this is the same as $A_L^0\times A_R^0$ if we ignore dashing.  By Lemma~\ref{lem:mainiso}, this is isomorphic to $A$ as a graph with colors and bigrading.  Since $\mu_2$ is obtained by pulling back $\mu$ from $A$, this isomorphism preserves dashing as well.
\end{proof}
